2003-2-4 Working code:
 New output format
 Added CI filter
 
const size_t NQ = 2;			// State dimension of noise
const size_t NX = NQ+0;			// State dimension (x,y) and some empty dummies so things are semidefinate
const size_t NZ = 2;			// Observation dimension
const size_t NS = 1000;			// Number of samples for a sampled representation

const bool RA_MODEL = true;		// Use Range angle NON-linear model (requires normalising angle)
const bool NOISE_MODEL = true;		// Add noise to truth model
const bool TRUTH_STATIONARY = false;// Truth model setup
const Float INIT_XY[2] = {1.,Float(-0.2)};// XY initial position
const Float TARGET[2] = {-11.,0.};	// XY position of target

const Float RANGE_NOISE = NOISE_MODEL ? Float(0.1) : Float(1e-6);
const Float ANGLE_NOISE = NOISE_MODEL ? Float(5. * angle<Float>::Pi / 180.) : Float(1e-6);
const Float Z_CORRELATION = Float(0e-1);	// Correlated observation model
const Float X_NOISE = Float(0.05);		// Prediction model
const Float Y_NOISE = Float(0.09);
const Float XY_NOISE_COUPLING = Float(0.05);
const Float INIT_X_NOISE = Float(0.07);
const Float INIT_Y_NOISE = Float(0.10);
const Float INIT_XY_NOISE_CORRELATION = Float(0.04);


udfilter, irfilter RA_MODEL:1 NOISE_MODEL:1 TRUTH_STATIONARY:0
*          0           0 *      1.000     -0.200       1.000     -0.200
           0           0 *      1.000     -0.200
   0.0000e+00   0.0000e+00   0.0000e+00   4.9000e-03   1.0000e-02   2.8000e-04
           0           0 *      1.000     -0.200
   0.0000e+00   0.0000e+00   0.0000e+00   4.9000e-03   1.0000e-02   2.8000e-04
*  1.081e-08    2.18e-07 *      1.060     -0.078     -10.938     -1.473
    -0.02549      0.0242 *      1.034     -0.053
   7.4203e-03   1.6306e-02   1.2720e-03   4.2633e-03   1.5991e-02   7.6486e-04
    -0.02549      0.0242 *      1.034     -0.053
   7.4202e-03   1.6306e-02   1.2720e-03   4.2633e-03   1.5991e-02   7.6486e-04
*  1.957e-07   4.538e-06 *      1.109      0.074     -11.092     -1.451
     0.03199     0.03497 *      1.141      0.109
   6.7836e-03   2.1239e-02   1.6447e-03   4.0375e-03   2.0664e-02   9.2310e-04
     0.03199     0.03497 *      1.141      0.109
   6.7836e-03   2.1239e-02   1.6447e-03   4.0375e-03   2.0664e-02   9.2310e-04
*  1.112e-07   4.792e-06 *      1.124      0.274     -10.855     -0.982
    -0.02075    -0.05179 *      1.103      0.222
   6.5578e-03   2.5051e-02   1.7645e-03   3.9469e-03   2.4226e-02   8.7432e-04
    -0.02075     -0.0518 *      1.103      0.222
   6.5578e-03   2.5051e-02   1.7645e-03   3.9469e-03   2.4226e-02   8.7432e-04
*  5.791e-08   5.553e-06 *      1.067      0.412     -10.925      0.299
   -0.009514     -0.1227 *      1.058      0.289
   6.4671e-03   2.7926e-02   1.7116e-03   3.9098e-03   2.6907e-02   7.4251e-04
   -0.009514     -0.1227 *      1.058      0.289
   6.4671e-03   2.7926e-02   1.7116e-03   3.9098e-03   2.6907e-02   7.4251e-04

cfilter, ifilter RA_MODEL:1 NOISE_MODEL:1 TRUTH_STATIONARY:0
*          0           0 *      1.000     -0.200       1.000     -0.200
           0           0 *      1.000     -0.200
   0.0000e+00   0.0000e+00   0.0000e+00   4.9000e-03   1.0000e-02   2.8000e-04
           0           0 *      1.000     -0.200
   0.0000e+00   0.0000e+00   0.0000e+00   4.9000e-03   1.0000e-02   2.8000e-04
*          0           0 *      1.060     -0.078     -10.938     -1.473
    -0.02549      0.0242 *      1.034     -0.053
   7.4203e-03   1.6306e-02   1.2720e-03   4.2633e-03   1.5991e-02   7.6486e-04
    -0.02549      0.0242 *      1.034     -0.053
   7.4203e-03   1.6306e-02   1.2720e-03   4.2633e-03   1.5991e-02   7.6486e-04
*          0  -1.388e-17 *      1.109      0.074     -11.092     -1.451
     0.03199     0.03497 *      1.141      0.109
   6.7836e-03   2.1239e-02   1.6447e-03   4.0375e-03   2.0664e-02   9.2310e-04
     0.03199     0.03497 *      1.141      0.109
   6.7836e-03   2.1239e-02   1.6447e-03   4.0375e-03   2.0664e-02   9.2310e-04
*  -2.22e-16  -2.776e-17 *      1.124      0.274     -10.855     -0.982
    -0.02075     -0.0518 *      1.103      0.222
   6.5578e-03   2.5051e-02   1.7645e-03   3.9469e-03   2.4226e-02   8.7432e-04
    -0.02075     -0.0518 *      1.103      0.222
   6.5578e-03   2.5051e-02   1.7645e-03   3.9469e-03   2.4226e-02   8.7432e-04
*          0  -5.551e-17 *      1.067      0.412     -10.925      0.299
   -0.009514     -0.1227 *      1.058      0.289
   6.4671e-03   2.7926e-02   1.7116e-03   3.9098e-03   2.6907e-02   7.4251e-04
   -0.009514     -0.1227 *      1.058      0.289
   6.4671e-03   2.7926e-02   1.7116e-03   3.9098e-03   2.6907e-02   7.4251e-04

ufilter, ijfilter RA_MODEL:1 NOISE_MODEL:1 TRUTH_STATIONARY:0
*          0           0 *      1.000     -0.200       1.000     -0.200
           0           0 *      1.000     -0.200
   0.0000e+00   0.0000e+00   0.0000e+00   4.9000e-03   1.0000e-02   2.8000e-04
           0           0 *      1.000     -0.200
   0.0000e+00   0.0000e+00   0.0000e+00   4.9000e-03   1.0000e-02   2.8000e-04
* -0.0002911  -4.666e-05 *      1.060     -0.078     -10.938     -1.473
    -0.02578     0.02416 *      1.034     -0.053
   7.4203e-03   1.6306e-02   1.2720e-03   4.2635e-03   1.5991e-02   7.6497e-04
    -0.02549      0.0242 *      1.034     -0.053
   7.4203e-03   1.6306e-02   1.2720e-03   4.2633e-03   1.5991e-02   7.6486e-04
* -0.0005373  -0.0001384 *      1.109      0.074     -11.092     -1.451
     0.03145     0.03483 *      1.140      0.109
   6.7838e-03   2.1239e-02   1.6448e-03   4.0378e-03   2.0665e-02   9.2342e-04
     0.03199     0.03497 *      1.141      0.109
   6.7836e-03   2.1239e-02   1.6447e-03   4.0375e-03   2.0664e-02   9.2310e-04
* -0.0007261  -0.0002314 *      1.124      0.274     -10.855     -0.982
    -0.02148    -0.05203 *      1.102      0.222
   6.5581e-03   2.5051e-02   1.7649e-03   3.9473e-03   2.4226e-02   8.7495e-04
    -0.02075     -0.0518 *      1.103      0.222
   6.5578e-03   2.5051e-02   1.7645e-03   3.9469e-03   2.4226e-02   8.7432e-04
* -0.0008843   -0.000322 *      1.067      0.412     -10.925      0.299
     -0.0104      -0.123 *      1.057      0.289
   6.4676e-03   2.7927e-02   1.7122e-03   3.9104e-03   2.6908e-02   7.4347e-04
   -0.009514     -0.1227 *      1.058      0.289
   6.4671e-03   2.7926e-02   1.7116e-03   3.9098e-03   2.6907e-02   7.4251e-04

cifilter, sfilter RA_MODEL:1 NOISE_MODEL:1 TRUTH_STATIONARY:0
*   0.002174    0.002834 *      1.000     -0.200       1.000     -0.200
           0           0 *      1.000     -0.200
   0.0000e+00   0.0000e+00   0.0000e+00   4.9000e-03   1.0000e-02   2.8000e-04
   -0.002174   -0.002834 *      0.998     -0.203
   0.0000e+00   0.0000e+00   0.0000e+00   5.8889e-03   1.1078e-02   3.9824e-04
* -0.0002216   -0.001461 *      1.060     -0.078     -10.938     -1.473
    -0.02549      0.0242 *      1.034     -0.053
   7.4203e-03   1.6306e-02   1.2720e-03   8.5267e-03   3.1982e-02   1.5297e-03
    -0.02527     0.02567 *      1.034     -0.052
   8.0820e-03   1.6301e-02   1.8562e-03   5.5623e-03   1.7241e-02   1.6483e-03
*    0.03428     0.01178 *      1.109      0.074     -11.092     -1.451
     0.06381     0.05953 *      1.173      0.133
   1.1047e-02   3.4372e-02   2.7594e-03   1.0483e-02   6.5908e-02   2.3846e-03
     0.02953     0.04775 *      1.139      0.122
   8.1131e-03   2.1507e-02   2.4668e-03   4.7014e-03   2.1715e-02   1.3853e-03
*  -0.006473     0.03539 *      1.124      0.274     -10.855     -0.982
    -0.02371   -0.009998 *      1.100      0.264
   1.3003e-02   6.2026e-02   3.7245e-03   1.1250e-02   1.1571e-01   1.7962e-03
    -0.01724    -0.04539 *      1.106      0.229
   6.9421e-03   2.5921e-02   2.4112e-03   4.8829e-03   2.2628e-02   9.6794e-04
*    -0.0301    -0.00175 *      1.067      0.412     -10.925      0.299
    -0.03218     -0.1104 *      1.035      0.301
   1.3771e-02   1.0226e-01   3.2716e-03   1.1556e-02   1.8468e-01  -5.3665e-04
   -0.002077     -0.1086 *      1.065      0.303
   7.2093e-03   2.5891e-02   1.7567e-03   4.7550e-03   2.4336e-02   8.6829e-04
