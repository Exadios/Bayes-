x,P,v,R,H

PHt = P*H';
S = H*PHt + R;

Sc = chol(S);	// Matlab defines upper tri Sc as Sc'*Sc = S
Sci = inv(Sc);

Wc = PHt * Sci;		// Sci' if Sc*Sc' = S
W = Wc * Sci';		// Sci  if Sc*Sc' = S

x = x + W*v;
P = P - Wc*Wc';